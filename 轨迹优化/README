# 轨迹优化插值方法

目的：**已知一些离散点，插值出一些新的点，使得所有点形成一条平滑曲线**

对于轨迹“平滑”，通常有不同的约束
1. 要求生成的曲线是连续的
2. 在1的基础上，要求参考曲线的速度是连续的
3. 在1和2的基础上，要求参考曲线的加速度是连续的

对于轨迹 $q$ 而言
$$
s = q(t) \\
v = \dot{q}(t) \\
a = \ddot{q}(t) \\
jerk = \dddot{q}(t) \\
$$

## 多项式插值






## 贝塞尔曲线插值
假如有 $n+1$ 个控制点 $P_0,P_1,\cdots,P_n$ 这$ n+1$ 个点可以确定一条 $n$ 次贝塞尔曲线，如下式所示

$$
B(t)=\sum_{i=0}^{n}{C_{n}^{i}(1-t)^{n-i}t^iP_i} \quad t \in [0,1]
$$
其中
$$
C_n^i=\frac{n!}{i!(n-i)!}
$$

例如，二次贝塞尔曲线
$$
B(t) = (1-t)^2P_0+2(1-t)tP_1 + t^2P_2 \quad t \in [0,1] 
$$
三次贝塞尔曲线
$$
B(t) = (1-t)^3P_0 + 3(1-t)^2tP_1+ 3(1-t)t^2P_2 + t^3P_3 \quad t \in [0,1]
$$
对于三次贝塞尔曲线而言： 

$t=0, B(0)=P_0; t=1, B(1) = P_3$ ，满足了起点和终点的条件

还需要额外知道两个控制点的信息（通常由速度大小和速度方向提供） 

 常用方法：指定起点点起点和终点的切线方向
起点的一阶导数与控制点有关系
- 曲线在$P_0$点的切线方向与向量$P_1 - P_0$ 平行
- 曲线在$P_3$ 点的切线方向与向量 $ P_2 - P_3$ 平行

引入权重参数，切向量的模长决定控制点离锚点$(P_0, P_3)$ 的远近程度，从而控制曲线的“紧绷”程度。模长越长，曲线在离开锚点时越冲，形成的曲线越膨大。模长越短，曲线越贴近锚点之间

计算控制点如下
- $P_1 = P_0 + (\frac{\alpha}{3})\times T_0$
- $P_2 = P_3 - (\frac{\beta}{3})\times T_3$
其中， $\alpha, \beta$用来控制模长，$T_0, T_3$表示$P_0, P_3$处的切向量


贝塞尔曲线需要注意：
- 贝塞尔曲线是通过控制点生成的，控制点不全在最终曲线上
- 控制点首尾的两点是最终曲线的端点（**首尾两个端点一定在曲线上**），且各自与相邻点的连线同最终曲线相切
- 两个贝塞尔曲线如果平滑连接，则需要连接点与其左右相邻两端点共线





## B样条插值


